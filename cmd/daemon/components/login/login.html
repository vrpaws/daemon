<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>VRPAWS Login</title>
    <style>
        /* full-page gradient & centering */
        html, body {
            height: 100%;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: sans-serif;
            background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
            color: #fff;
        }
        .container {
            text-align: center;
        }
        button {
            padding: 1em 2em;
            font-size: 1.1rem;
            border: none;
            border-radius: 8px;
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            cursor: pointer;
            transition: transform 0.2s;
        }
        button:hover {
            transform: scale(1.05);
        }
        .message {
            font-size: 1.2rem;
            margin-bottom: 1em;
        }
        .count {
            font-weight: bold;
        }
    </style>
</head>
<body>
<div class="container" id="app">
    <!-- content injected by JS -->
</div>

<script>
    (function() {
        const params = new URLSearchParams(window.location.search);
        const token = params.get('access_token');
        const container = document.getElementById('app');

        if (!token) {
            // --- Default: show login button ---
            const msg = document.createElement('div');
            msg.className = 'message';
            msg.textContent = 'Please log in with VRPAWS to continue';
            const btn = document.createElement('button');
            btn.textContent = 'Log in with VRPAWS';
            btn.onclick = () => {
                // redirect to the VRPAWS flow
                window.location.href =
                    'http://vrpa.ws/client/connect?redirect_url=' +
                    encodeURIComponent('{CALLBACK_URL}') +
                    '&service_name=vrpaws-client';
            };
            container.appendChild(msg);
            container.appendChild(btn);

        } else {
            // --- Success: show countdown and auto-close ---
            const msg = document.createElement('div');
            msg.className = 'message';
            msg.textContent = 'Login successful! This window will close in ';
            const span = document.createElement('span');
            span.className = 'count';
            let seconds = 5;
            span.textContent = seconds;
            msg.appendChild(span);
            container.appendChild(msg);

            const tick = setInterval(() => {
                seconds -= 1;
                span.textContent = seconds;
                if (seconds <= 0) {
                    clearInterval(tick);
                    window.close();
                }
            }, 1000);
        }
    })();
</script>
</body>
</html>
